<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>

 	<f:facet name="first">
            <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
            <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>
          <title>Cards</title>
       </f:facet>

	<!-- Ovo je da se moze dinamicki dodati draggable komponenta, bez toga ne radi -->
	<h:outputScript name="jquery/jquery-plugins.js" library="primefaces"/>
	<h:outputScript library="js" name="script.js" />

</h:head>

<h:body>

<h:form id="mainForm">

	<p:toolbar>
		<f:facet name="left">
			<p:outputLabel id="side1label" value="Prednja strana"></p:outputLabel>
		</f:facet>
		<f:facet name="right">
			<p:commandButton value="Statički tekst" icon="ui-icon-circle-plus" actionListener="#{cardDesignerController.addNewCardElement(1,1)}" update="mainForm" />
			<p:commandButton value="Polje" icon="ui-icon-circle-plus" actionListener="#{cardDesignerController.addNewCardElement(1,2)}" update="mainForm" />
			<p:commandButton value="Slika" icon="ui-icon-circle-plus" actionListener="#{cardDesignerController.addNewCardElement(1,3)}" update="mainForm" />
			<p:commandButton value="Potpis" icon="ui-icon-circle-plus" actionListener="#{cardDesignerController.addNewCardElement(1,4)}" update="mainForm" />
		</f:facet>
	</p:toolbar>


<!-- panel prednje strane kartice -->
<p:outputPanel 
	id="frontSide" 
	name="frontSide" 
	layout="block" 
	style="width:400px;height:200px;border:1px solid #666666;margin-bottom:20px;margin-left:20px;	background-image: url('images/card_template1.jpg');"
/>


<p:toolbar>
		<f:facet name="left">
			<p:outputLabel id="side2label" value="Stražnja strana"></p:outputLabel>
		</f:facet>
		<f:facet name="right">
			<p:commandButton value="Statički tekst" icon="ui-icon-circle-plus" actionListener="#{cardDesignerController.addNewCardElement(2,1)}" update="mainForm" />
			<p:commandButton value="Polje" icon="ui-icon-circle-plus" actionListener="#{cardDesignerController.addNewCardElement(2,2)}" update="mainForm" />
			<p:commandButton value="Slika" icon="ui-icon-circle-plus" actionListener="#{cardDesignerController.addNewCardElement(2,3)}" update="mainForm" />
			<p:commandButton value="Potpis" icon="ui-icon-circle-plus" actionListener="#{cardDesignerController.addNewCardElement(2,4)}" update="mainForm" />
		</f:facet>
	</p:toolbar>


<!-- panel stražnje strane kartice -->
<p:outputPanel 
	id="backSide" 
	name="backSide"  
	layout="block" 
	style="width:400px;height:200px;border:1px solid #666666;margin-bottom:20px;margin-left:20px;background-image: url('images/card_template2.png');"
/>

<p:panel id="elementDataPanel1" header="Osnovni podaci elementa"  >

	<!-- Za editor se ne moze dodati p:ajax a valueChangeListener se okida tek nakon submita, zato se koristi remote command -->
	
	<p:outputLabel value="Naziv elementa" />
	<p:inputText 
		id="elementName" 
		value="#{cardDesignerController.selectedElement.name}" 
	/>
	
	<p:outputLabel value="Pozicija X" />
	<p:inputText 
		id="elementPositionX" 
		onchange="updateElementMap()" 
		value="#{cardDesignerController.selectedElement.positionX}" 
		disabled="#{cardDesignerController.selectedElement.type == null}"
	/>
	
	<p:outputLabel value="Pozicija Y" />
	<p:inputText 
		id="elementPositionY" 
		onchange="updateElementMap()" 
		value="#{cardDesignerController.selectedElement.positionY}" 
		disabled="#{cardDesignerController.selectedElement.type == null}"
	/>
	
	<p:outputLabel value="Širina polja u mm" />
	<p:inputText 
		id="elementWidth" 
		onchange="updateElementMap()" 
		value="#{cardDesignerController.selectedElement.width}" 
		disabled="#{cardDesignerController.selectedElement.type == null}"
	/>
	
	<p:outputLabel value="Visina polja u mm" />
	<p:inputText 
		id="elementHeight" 
		onchange="updateElementMap()" 
		value="#{cardDesignerController.selectedElement.height}" 
		disabled="#{cardDesignerController.selectedElement.type == null}"
	/>

</p:panel>


<p:panel id="elementDataPanel2" header="Statički / inicijalni tekst" >

	<p:editor 
		id="elementEditor"  
		onchange="updateElementMap()"
		width="250" 
		height="100" 
		controls="bold italic underline font size color undo redo" 
		value="#{cardDesignerController.selectedElement.value}"  
		disabled="#{cardDesignerController.selectedElement.type == null or cardDesignerController.selectedElement.type == 3}"
	/>

</p:panel>


<p:panel id="elementDataPanel3" header="Dodatni podaci polja" >

	<!-- Ovo se pokazuje samo ako je element varijabilni - korisnicki unos -->
	
	<p:outputLabel value="Tip podatka" />
	<p:selectOneMenu 
		id="elementDataType" 
		value="#{cardDesignerController.selectedElement.dataType}" 
		disabled="#{cardDesignerController.selectedElement.type == null or cardDesignerController.selectedElement.type == 1}"   > 
			<f:selectItem itemLabel="Tekst" itemValue="1" />
			<f:selectItem itemLabel="Broj" itemValue="2" />
			<f:selectItem itemLabel="Datum" itemValue="3" />
			<f:selectItem itemLabel="Serijski broj" itemValue="4" />
			<p:ajax 
				event="change" 
				process="@this" 
				listener="#{cardDesignerController.changeDataType}" 
				update="mainForm:elementMinimumLength, mainForm:elementMaximumLength, mainForm:dateFormat, mainForm:startCardNumber, mainForm:elementRequired"
			/>
	</p:selectOneMenu>
	
	
	<!-- samo za tekstualna polja -->
	<p:outputLabel value="Minimalni broj znakova" />
	<p:inputText 
		id="elementMinimumLength" 
		value="#{cardDesignerController.selectedElement.minCharLength}" 
		disabled="#{cardDesignerController.selectedElement.type == null or cardDesignerController.selectedElement.type != 2 or cardDesignerController.selectedElement.dataType != 1}" 
	/>
	
	<p:outputLabel value="Maksimalni broj znakova" />
	<p:inputText 
		id="elementMaximumLength" 
		value="#{cardDesignerController.selectedElement.maxCharLength}" 
		disabled="#{cardDesignerController.selectedElement.type == null or cardDesignerController.selectedElement.type != 2 or cardDesignerController.selectedElement.dataType != 1}" 
	/>
	
	<!-- samo za datumska polja  -->
	<p:outputLabel value="Format datuma" />
	<p:inputText 
		id="dateFormat" 
		value="#{cardDesignerController.selectedElement.dateFormat}" 
		disabled="#{cardDesignerController.selectedElement.type == null or cardDesignerController.selectedElement.type != 2 or cardDesignerController.selectedElement.dataType != 3}" 
	/>
	
	<!-- samo za serijski broj -->
	<p:outputLabel value="Početni serijski broj kartice" />
	<p:inputText 
		id="startCardNumber" 
		disabled="#{cardDesignerController.selectedElement.type == null or cardDesignerController.selectedElement.type != 2 or cardDesignerController.selectedElement.dataType != 4}" 
	/>
	
	
	<p:outputLabel value="Podatak obavezan" />
	<p:selectOneMenu 
		id="elementRequired" 
		value="#{cardDesignerController.selectedElement.required}"  
		disabled="#{cardDesignerController.selectedElement.type == null or cardDesignerController.selectedElement.type != 2 or cardDesignerController.selectedElement.dataType == 4}" >
			<f:selectItem itemLabel="DA" itemValue="true" />
			<f:selectItem itemLabel="NE" itemValue="false" />
	</p:selectOneMenu>

</p:panel>

<p:panel id="elementDataPanel4" header="Inicijalna slika / potpis" >

</p:panel>


 <p:commandButton value="Submit"  icon="ui-icon-disk" actionListener="#{cardDesignerController.saveCardTemplate}"/>
 
 
 <!-- remote komande - javascript -->
 <p:remoteCommand 
 	name="displayFormValues" 
 	actionListener="#{cardDesignerController.displayFormValuesFromObject}" 
 	immediate="true" 
 />
 <p:remoteCommand 
 	name="saveFormValues" 
 	actionListener="#{cardDesignerController.saveFormValuesIntoObject}"  
 	immediate="true" 
 />
 <p:remoteCommand 
 	name="refreshEditorValueOnly" 
 	actionListener="#{cardDesignerController.refreshEditorValueOnly}"  
 	immediate="true" 
 />
  
  
 <h:inputHidden id="selectedId" value="#{cardDesignerController.selectedId}"></h:inputHidden>
 

</h:form>

</h:body>
</html>